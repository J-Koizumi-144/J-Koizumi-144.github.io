<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>25TILES</title>
<style>
  :root { --tile-size: 100px; --gap: 6px; --mini: 20px; }
  body {
    margin: 0; min-height: 100vh;
    display: grid; place-items: center;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto,
                 "Hiragino Sans", "Noto Sans JP", sans-serif;
    background: #f6f7f9;
  }
  main { text-align: center; width: min(680px, 96vw); }

  /* ヘッダー：お手本プレビューと状態表示 */
  .header {
    display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: center;
    margin-bottom: 12px;
  }
  .preview-card {
    width: 112px;
    display: flex; align-items: center; gap: 12px;
    background: #ddd; border: 1px solid #e2e6ef; border-radius: 12px;
    padding: 10px 12px; box-shadow: 0 4px 16px rgba(0,0,0,.06);
  }
  .preview-card .label { font-weight: 600; color: #394150; }
  .mini {
    display: grid; grid-template-columns: repeat(5, var(--mini)); gap: 3px;
  }
  .mini-tile {
    width: var(--mini); height: var(--mini);
    border-radius: 3px; background: #fff; border: none;
  }
  .mini-tile.black { background: #111;}
  .mini-tile.red { background: #5bc;}

  .status-area { text-align: right; }
  .status-text { font-weight: 600; color: #6b7280; font-size: 24px; }
  .btn {
    margin-left: .5rem; padding: .5rem .75rem;
    border-radius: 10px; border: 2px solid #333333; background: #fff;
    cursor: pointer; transition: transform .05s ease;
    color: #222;
  }
  .btn:active { transform: scale(.98); }
  .btn:disabled { opacity: .5; cursor: not-allowed; }
  .btn.primary { background: #111; color: #fff; border-color: #111; }

  .board-wrap { background: #ddd; border-radius: 12px; box-shadow: 0 6px 24px rgba(0,0,0,.08); padding: 16px; position: relative; }
  .board-wrap.cleared { background: rgb(249, 223, 146); }
  .board-wrap::before {
    content: "";
    position: absolute;
    left: 50%; top: 50%;
    width: 0; height: 0;
    border: 20px solid rgb(249, 223, 146); border-radius: 50%;
    transform: translate(-50%, -50%);
    opacity: 0;
    pointer-events: none;
    z-index: 5;
  }
  
  .board-wrap.is-cleared::before {
    animation: ring-grow 400ms ease-out forwards;
  }

  @keyframes ring-grow {
    0%   { width: 100px; height: 100px; opacity: 1.0; }
    70%  { opacity: 0.8; }
    100% { width: 400px; height: 400px; opacity: 0; }
  }

  .board {
    display: grid;
    grid-template-columns: auto repeat(5, var(--tile-size));
    grid-template-rows: auto repeat(5, var(--tile-size));
    gap: var(--gap);
    align-items: center;
    justify-items: center;
    padding: 20px;
  }

  .tile {
    width: var(--tile-size); height: var(--tile-size);
    border-radius: 6px; background: #fff;
    transition: background-color .15s ease, box-shadow .15s ease;
  }
  .tile.black { background: #222;}
  .tile.red { background: #2bc;}

  .ctrl {
    width: 54px; height: 54px; border-radius: 50%; margin: 5px;
    border: none; background: #fff; cursor: pointer;
    display: grid; place-items: center; position: relative;
    transition: transform .05s ease, background .15s ease, border-color .15s ease;
  }
  .ctrl:active { transform: scale(.96); }

  /* オーバーレイ（タイトル/結果） */
  .overlay {
    position: fixed; inset: 0; display: none; align-items: center; justify-content: center;
    padding: 24px; background: rgba(15,18,24,.5); z-index: 10;
  }
  .overlay.show { display: flex; }
  .modal {
    background: #fff; border: 1px solid #e6e8f0; border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,.15); width: min(560px, 92vw);
    padding: 24px; text-align: center;
  }
  .modal h1, .modal h2 { margin: 0 0 8px; color: #111827; }
  .modal p { margin: 4px 0 16px; color: #4b5563; }
  .modal .actions { display: flex; gap: 8px; justify-content: center; }

  @media (max-width: 480px) {
    :root { --tile-size: 44px; }
    .ctrl, .top-left { width: 30px; height: 30px; }
  }

  #timerText {
    display: inline-block;
    min-width: 100px; /* 必要な幅に合わせて調整 */
    text-align: left; /* または center */
  }

  #statusText {
    display: inline-block;
    min-width: 200px; /* 必要な幅に合わせて調整 */
    text-align: left; /* または center */
  }

  #resultText {
    font-size: 24px;
  }
  
  /*ダブルタップ対策*/
  html, body { touch-action: manipulation; }
  button, .ctrl { touch-action: manipulation; }

  #leaderboardTable {
    border-collapse: collapse;
    width: 100%;
  }

  #leaderboardTable th,
  #leaderboardTable td {
    padding: 4px 8px;
    text-align: left;
    border: none; /* 枠なし */
  }

  .form-group {
    display: flex;
    align-items: center;
    margin: 20px 0;
  }

  .form-group label {
    width: 140px;           /* ラベル幅を固定して左右を揃える */
    font-weight: 600;
  }

  .input {
    flex: 1;                /* 残りの幅いっぱいを入力欄に */
    padding: 6px 8px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
  }


</style>
</head>
<body>
<main>
  <div style="margin: 20%;"></div>
  <div class="header">
    <div class="preview-card">
      <div class="mini" id="targetPreview" aria-label="お手本プレビュー"></div>
    </div>
    <div class="status-area">
      <span id="statusText" class="status-text" aria-live="polite">SCORE: 0</span>
      <span id="timerText" class="status-text" aria-live="polite">30.0</span>
      <button id="newBtn" class="btn" type="button">NEXT</button>
      <button id="resetBtn" class="btn" type="button">RESET</button>
    </div>
  </div>

  <div class="board-wrap" id="boardWrap">
    <div class="board" id="board" aria-label="タイル盤">
      <div class="top-left" aria-hidden="true" style="width:36px;height:36px;"></div>
      <!-- 以降はJSで生成 -->
    </div>
  </div>

  <div style="margin: 20%;"></div>
</main>

<!-- タイトル画面 -->
<div id="titleScreen" class="overlay show" aria-modal="true" role="dialog">
  <div class="modal">
    <h1>25TILES</h1>
    <p>A random pattern will appear in the upper-left corner.</br>左上にランダムな模様が表示されます。</p>
    <p>Color rows and columns and recreate the pattern.</br>行や列に色を塗って同じ模様を作ってください。</p>
    <p>Pressing a button multiple times will cycle through the available colors.</br>ボタンを複数回押すと塗られる色が変わります。</p>
    <div class="actions">
      <button id="startBtn" class="btn primary" type="button">START</button>
      <button id="rankingBtn" class="btn" type="button">RANKING</button>
    </div>
  </div>
</div>

<!-- ロード画面 -->
<div id="loadScreen" class="overlay" aria-modal="true" role="dialog">
  <div class="modal">
    <h1>Loading...</h1>
  </div>
</div>

<!-- ランキング画面 -->
<div id="rankingScreen" class="overlay" aria-modal="true" role="dialog">
  <div class="modal">
    <h1>Ranking</h1>
    <div id="leaderboard">
      <table id="leaderboardTable" style="color: #555;">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="actions">
      <button id="rankingCloseBtn" class="btn" type="button">BACK</button>
    </div>
  </div>
</div>

<!-- 結果画面 -->
<div id="resultScreen" class="overlay" aria-modal="true" role="dialog" aria-hidden="true">
  <div class="modal">
    <h2>TIME'S UP!</h2>
    <p id="resultText"></p>
    <div style = "margin: 10px;">
      <button id="tweetBtn" class="btn" type="button">TWEET</button>
    </div>
    <div style = "margin: 10px;">
      <button id="scoreRegBtn" class="btn" type="button">SUBMIT SCORE</button>
    </div>
    <div class="actions">
      <button id="toTitleBtn" class="btn primary" type="button">BACK TO TITLE</button>
    </div>
  </div>
</div>

<!-- Score Registration Modal -->
<div id="scoreModal" class="overlay" aria-modal="true" role="dialog">
  <div class="modal">
    <h2>Score Registration</h2>
    <p>Please use the same User ID each time.</br>User IDは毎回同じものを用いてください。</p>
    <div class="form-group">
      <label for="regName">Name</label>
      <input type="text" id="regName" class="input" />
    </div>
    <div class="form-group">
      <label for="regID">User ID (private)</label>
      <input type="text" id="regID" class="input" />
    </div>
    <div class="actions">
      <button id="submitScoreBtn" class="btn primary" type="button">REGISTER</button>
      <button id="closeScoreModalBtn" class="btn" type="button">CANCEL</button>
    </div>
  </div>
</div>



<script>
(() => {
const _0x5df794=_0x227d;(function(_0x425d74,_0x5a959d){const _0x39496d=_0x227d,_0x53bbd4=_0x425d74();while(!![]){try{const _0x734e05=-parseInt(_0x39496d(0x9f))/0x1*(parseInt(_0x39496d(0xce))/0x2)+-parseInt(_0x39496d(0x101))/0x3*(parseInt(_0x39496d(0x102))/0x4)+parseInt(_0x39496d(0xb6))/0x5+-parseInt(_0x39496d(0xe6))/0x6*(-parseInt(_0x39496d(0xb0))/0x7)+-parseInt(_0x39496d(0xc4))/0x8*(parseInt(_0x39496d(0xf3))/0x9)+-parseInt(_0x39496d(0x107))/0xa*(-parseInt(_0x39496d(0xda))/0xb)+parseInt(_0x39496d(0xd6))/0xc*(parseInt(_0x39496d(0xae))/0xd);if(_0x734e05===_0x5a959d)break;else _0x53bbd4['push'](_0x53bbd4['shift']());}catch(_0x106569){_0x53bbd4['push'](_0x53bbd4['shift']());}}}(_0x2648,0x9aee3));const N=0x5,DURATION_MS=0xea60,board=document[_0x5df794(0xb4)](_0x5df794(0xd4)),preview=document[_0x5df794(0xb4)]('targetPreview'),statusText=document['getElementById']('statusText'),timerText=document[_0x5df794(0xb4)](_0x5df794(0xdb)),newBtn=document[_0x5df794(0xb4)](_0x5df794(0xed)),resetBtn=document[_0x5df794(0xb4)](_0x5df794(0xf5)),titleScreen=document[_0x5df794(0xb4)](_0x5df794(0xc9)),resultScreen=document[_0x5df794(0xb4)](_0x5df794(0xd1)),resultText=document[_0x5df794(0xb4)]('resultText'),startBtn=document[_0x5df794(0xb4)](_0x5df794(0xbc)),toTitleBtn=document[_0x5df794(0xb4)](_0x5df794(0xd9)),boardWrap=document[_0x5df794(0xb4)](_0x5df794(0xb9)),scoreRegBtn=document[_0x5df794(0xb4)](_0x5df794(0xe2)),scoreModal=document[_0x5df794(0xb4)](_0x5df794(0xc5)),submitScoreBtn=document[_0x5df794(0xb4)](_0x5df794(0xd8)),closeScoreModalBtn=document[_0x5df794(0xb4)]('closeScoreModalBtn'),regName=document['getElementById'](_0x5df794(0xd0)),regID=document[_0x5df794(0xb4)]('regID'),rankingScreen=document['getElementById']('rankingScreen'),rankingBtn=document['getElementById']('rankingBtn'),rankingCloseBtn=document['getElementById'](_0x5df794(0xfa)),loadScreen=document[_0x5df794(0xb4)](_0x5df794(0xb2));rankingBtn[_0x5df794(0xaf)](_0x5df794(0xec),()=>{const _0x178121=_0x5df794;titleScreen[_0x178121(0xac)][_0x178121(0xde)](_0x178121(0xcb)),rankingScreen[_0x178121(0xac)][_0x178121(0xff)](_0x178121(0xcb));}),rankingCloseBtn[_0x5df794(0xaf)](_0x5df794(0xec),()=>{const _0x583ec4=_0x5df794;titleScreen[_0x583ec4(0xac)][_0x583ec4(0xff)](_0x583ec4(0xcb)),rankingScreen[_0x583ec4(0xac)]['remove'](_0x583ec4(0xcb));});for(let c=0x0;c<N;c++){const btn=document[_0x5df794(0x9a)]('button');btn[_0x5df794(0xa3)]=_0x5df794(0xb7),btn[_0x5df794(0xe3)]=_0x5df794(0xc8),btn[_0x5df794(0x108)][_0x5df794(0xe3)]=_0x5df794(0xa9),btn[_0x5df794(0x108)][_0x5df794(0x94)]=String(c),btn[_0x5df794(0xa0)]('aria-label','列\x20'+(c+0x1)+'\x20を操作'),btn['style'][_0x5df794(0xab)]=c+0x2,btn['style'][_0x5df794(0xe4)]=0x1,board[_0x5df794(0xd5)](btn);}for(let r=0x0;r<N;r++){const btn=document[_0x5df794(0x9a)](_0x5df794(0xc8));btn[_0x5df794(0xa3)]='ctrl',btn[_0x5df794(0xe3)]='button',btn[_0x5df794(0x108)]['type']=_0x5df794(0xa6),btn['dataset'][_0x5df794(0x94)]=String(r),btn[_0x5df794(0xa0)](_0x5df794(0xbe),'行\x20'+(r+0x1)+_0x5df794(0xe1)),btn[_0x5df794(0xe9)][_0x5df794(0xab)]=0x1,btn[_0x5df794(0xe9)][_0x5df794(0xe4)]=r+0x2,board['appendChild'](btn);for(let c=0x0;c<N;c++){const tile=document['createElement'](_0x5df794(0xb5));tile['className']=_0x5df794(0xa2),tile[_0x5df794(0x108)][_0x5df794(0xa6)]=String(r),tile[_0x5df794(0x108)][_0x5df794(0xa9)]=String(c),tile[_0x5df794(0xe9)][_0x5df794(0xab)]=c+0x2,tile['style'][_0x5df794(0xe4)]=r+0x2,board[_0x5df794(0xd5)](tile);}}let colormode=0x1,lastTarget=null,targetMatrix=Array[_0x5df794(0xdc)]({'length':N},()=>Array(N)[_0x5df794(0x104)](![])),inSession=![],clearedCurrent=![],solvedCount=0x0,timerId=null,endTime=0x0;function paintRow(_0x1ce014,_0x128750){const _0x26c954=_0x5df794;board['querySelectorAll'](_0x26c954(0x109)+_0x1ce014+'\x22]')['forEach'](_0x16d010=>{const _0x5410ae=_0x26c954;if(_0x128750==0x0)_0x16d010[_0x5410ae(0xac)][_0x5410ae(0xa4)](_0x5410ae(0xef),![]),_0x16d010[_0x5410ae(0xac)][_0x5410ae(0xa4)]('red',![]);else{if(_0x128750==0x1)_0x16d010[_0x5410ae(0xac)][_0x5410ae(0xa4)]('black',!![]),_0x16d010[_0x5410ae(0xac)][_0x5410ae(0xa4)](_0x5410ae(0xc3),![]);else _0x128750==0x2&&(_0x16d010[_0x5410ae(0xac)]['toggle'](_0x5410ae(0xef),![]),_0x16d010[_0x5410ae(0xac)][_0x5410ae(0xa4)](_0x5410ae(0xc3),!![]));}});}function paintCol(_0x5371b8,_0x101671){const _0x153d40=_0x5df794;board[_0x153d40(0xe0)](_0x153d40(0x105)+_0x5371b8+'\x22]')['forEach'](_0x21a401=>{const _0x5e3ee5=_0x153d40;if(_0x101671==0x0)_0x21a401['classList']['toggle']('black',![]),_0x21a401[_0x5e3ee5(0xac)][_0x5e3ee5(0xa4)](_0x5e3ee5(0xc3),![]);else{if(_0x101671==0x1)_0x21a401[_0x5e3ee5(0xac)]['toggle'](_0x5e3ee5(0xef),!![]),_0x21a401[_0x5e3ee5(0xac)][_0x5e3ee5(0xa4)](_0x5e3ee5(0xc3),![]);else _0x101671==0x2&&(_0x21a401[_0x5e3ee5(0xac)][_0x5e3ee5(0xa4)](_0x5e3ee5(0xef),![]),_0x21a401[_0x5e3ee5(0xac)][_0x5e3ee5(0xa4)](_0x5e3ee5(0xc3),!![]));}});}function getBoardState(){const _0x1f2529=_0x5df794,_0x221426=Array[_0x1f2529(0xdc)]({'length':N},()=>Array(N)[_0x1f2529(0x104)](0x0));return board[_0x1f2529(0xe0)]('.tile')[_0x1f2529(0xa1)](_0x2c2ad3=>{const _0x16f53f=_0x1f2529,_0x2dd416=Number(_0x2c2ad3['dataset'][_0x16f53f(0xa6)]),_0x32aa7f=Number(_0x2c2ad3[_0x16f53f(0x108)][_0x16f53f(0xa9)]);if(_0x2c2ad3[_0x16f53f(0xac)][_0x16f53f(0xc0)](_0x16f53f(0xef)))_0x221426[_0x2dd416][_0x32aa7f]=0x1;else _0x2c2ad3[_0x16f53f(0xac)]['contains']('red')?_0x221426[_0x2dd416][_0x32aa7f]=0x2:_0x221426[_0x2dd416][_0x32aa7f]=0x0;}),_0x221426;}function sameMatrix(_0x4b2cc5,_0x488daf){for(let _0x437634=0x0;_0x437634<N;_0x437634++)for(let _0x19d0e9=0x0;_0x19d0e9<N;_0x19d0e9++)if(_0x4b2cc5[_0x437634][_0x19d0e9]!==_0x488daf[_0x437634][_0x19d0e9])return![];return!![];}function renderTargetPreview(){const _0x458a6c=_0x5df794;preview[_0x458a6c(0xa5)]='';for(let _0x56f860=0x0;_0x56f860<N;_0x56f860++)for(let _0x5017d8=0x0;_0x5017d8<N;_0x5017d8++){const _0x345e46=document[_0x458a6c(0x9a)](_0x458a6c(0xb5));if(targetMatrix[_0x56f860][_0x5017d8]==0x1)_0x345e46[_0x458a6c(0xa3)]=_0x458a6c(0x103);else targetMatrix[_0x56f860][_0x5017d8]==0x2?_0x345e46[_0x458a6c(0xa3)]=_0x458a6c(0xc2):_0x345e46[_0x458a6c(0xa3)]='mini-tile';preview['appendChild'](_0x345e46);}}function boardAllWhite(){const _0x1cbd42=_0x5df794;board[_0x1cbd42(0xe0)](_0x1cbd42(0xf0))[_0x1cbd42(0xa1)](_0x2c1212=>_0x2c1212[_0x1cbd42(0xac)][_0x1cbd42(0xde)](_0x1cbd42(0xef))),board[_0x1cbd42(0xe0)](_0x1cbd42(0xf0))['forEach'](_0x2a1eda=>_0x2a1eda['classList'][_0x1cbd42(0xde)](_0x1cbd42(0xc3))),color=0x1,lastTarget=null,boardWrap[_0x1cbd42(0xac)]['remove']('cleared'),resetBtn[_0x1cbd42(0x95)]=![],board['querySelectorAll']('.ctrl')['forEach'](_0x2d5dd9=>_0x2d5dd9[_0x1cbd42(0x95)]=![]);}function ensureNonTrivial(_0x236d47){const _0x21ed1e=_0x5df794;let _0x1d0bf0=0x0;for(let _0x4d0b03=0x0;_0x4d0b03<N;_0x4d0b03++)for(let _0x51d5b2=0x0;_0x51d5b2<N;_0x51d5b2++)if(_0x236d47[_0x4d0b03][_0x51d5b2]!=0x0)_0x1d0bf0++;if(_0x1d0bf0===0x0){const _0xfcaa46=Math[_0x21ed1e(0xf8)](Math[_0x21ed1e(0xd2)]()*N);for(let _0x36fb0b=0x0;_0x36fb0b<N;_0x36fb0b++)_0x236d47[_0xfcaa46][_0x36fb0b]=0x1;}}function generateReachableTarget(){const _0x116e63=_0x5df794,_0x3c0424=Array[_0x116e63(0xdc)]({'length':N},()=>Array(N)['fill'](0x0));let _0xf5b0df=null,_0xd95867=0x0;if(solvedCount<0x5)_0xd95867=0x5;else{if(solvedCount<0xa)_0xd95867=0xa;else solvedCount<0x14?_0xd95867=0x1e:_0xd95867=0x64;}for(let _0x15bb8b=0x0;_0x15bb8b<_0xd95867;_0x15bb8b++){const _0x3cf96d=Math[_0x116e63(0xd2)]()<0.5?_0x116e63(0xa6):_0x116e63(0xa9),_0x57fb20=Math['floor'](Math['random']()*0x3),_0xb5b739=Math[_0x116e63(0xf8)](Math[_0x116e63(0xd2)]()*N);if(_0x3cf96d==='row'){for(let _0x248809=0x0;_0x248809<N;_0x248809++)_0x3c0424[_0xb5b739][_0x248809]=_0x57fb20;}else{for(let _0x4af5a8=0x0;_0x4af5a8<N;_0x4af5a8++)_0x3c0424[_0x4af5a8][_0xb5b739]=_0x57fb20;}}ensureNonTrivial(_0x3c0424),targetMatrix=_0x3c0424,renderTargetPreview(),newBtn[_0x116e63(0x95)]=!![],clearedCurrent=![];}function updateTimerDisplay(_0x3bd618){const _0x425dab=_0x5df794,_0x123155=Math['max'](0x0,_0x3bd618)/0x3e8;timerText[_0x425dab(0x97)]=''+_0x123155[_0x425dab(0xb1)](0x1);}function startTimer(){let _0x5d5622=0xea60;if(solvedCount<0x5)_0x5d5622=0xea60;else{if(solvedCount<0xa)_0x5d5622=0xc350;else{if(solvedCount<0x14)_0x5d5622=0x9c40;else solvedCount<0x1e?_0x5d5622=0x7530:_0x5d5622=0x61a8;}}endTime=Date['now']()+_0x5d5622,updateTimerDisplay(_0x5d5622);if(timerId)clearInterval(timerId);timerId=setInterval(()=>{const _0x3603f7=_0x227d,_0xe94351=Date[_0x3603f7(0xcc)](),_0x30f172=endTime-_0xe94351;updateTimerDisplay(_0x30f172),_0x30f172<=0x0&&(clearInterval(timerId),timerId=null,onTimeUp());},0x64);}function stopTimer(){timerId&&(clearInterval(timerId),timerId=null);}function triggerClearEffect(){const _0x53dda9=_0x5df794;boardWrap['classList'][_0x53dda9(0xff)]('is-cleared'),setTimeout(()=>{const _0x5dd87c=_0x53dda9;boardWrap[_0x5dd87c(0xac)]['remove'](_0x5dd87c(0x9d));},0x3e8);}function checkWin(){const _0x577ff1=_0x5df794;if(!inSession)return;const _0x93c63a=sameMatrix(getBoardState(),targetMatrix);_0x93c63a&&(!clearedCurrent&&(solvedCount+=0x1,clearedCurrent=!![],stopTimer(),hitSession()),triggerClearEffect(),statusText['textContent']='SCORE:\x20'+solvedCount*0xa,boardWrap[_0x577ff1(0xac)][_0x577ff1(0xff)](_0x577ff1(0xdd)),newBtn[_0x577ff1(0x95)]=![],resetBtn[_0x577ff1(0x95)]=!![],board[_0x577ff1(0xe0)](_0x577ff1(0x9b))[_0x577ff1(0xa1)](_0x488577=>_0x488577[_0x577ff1(0x95)]=!![]));}function onTimeUp(){const _0x31c5b8=_0x5df794;inSession=![],newBtn[_0x31c5b8(0x95)]=!![],resultText['textContent']=_0x31c5b8(0xfc)+solvedCount*0xa,resultScreen[_0x31c5b8(0xac)][_0x31c5b8(0xff)]('show'),resultScreen['removeAttribute'](_0x31c5b8(0xbb)),scoreRegBtn['disabled']=![];const _0x481998=document[_0x31c5b8(0xb4)](_0x31c5b8(0xf9)),_0x25cc4c=encodeURIComponent(_0x31c5b8(0xcf)+solvedCount*0xa+_0x31c5b8(0x98)),_0x3394e7='https://twitter.com/intent/tweet?text='+_0x25cc4c;_0x481998[_0x31c5b8(0x10a)]=()=>window['open'](_0x3394e7,_0x31c5b8(0xbf),'noopener,noreferrer');}function startSession(){const _0x2422a2=_0x5df794;solvedCount=0x0,inSession=!![],statusText[_0x2422a2(0x97)]=_0x2422a2(0x96),boardAllWhite(),generateReachableTarget(),startTimer();}function endSessionToTitle(){const _0x21c285=_0x5df794;inSession=![],stopTimer(),newBtn[_0x21c285(0x95)]=!![],updateTimerDisplay(DURATION_MS),targetMatrix=Array[_0x21c285(0xdc)]({'length':N},()=>Array(N)['fill'](![])),renderTargetPreview(),boardAllWhite(),statusText[_0x21c285(0x97)]='SCORE:\x200';}board[_0x5df794(0xaf)](_0x5df794(0xec),_0x5d32a2=>{const _0x445325=_0x5df794,_0x15b4ad=_0x5d32a2[_0x445325(0xa8)][_0x445325(0x106)](_0x445325(0x9b));if(!_0x15b4ad||!inSession)return;const _0x325f60=_0x15b4ad[_0x445325(0x108)][_0x445325(0xe3)],_0x1857de=Number(_0x15b4ad['dataset']['index']);lastTarget&&lastTarget[_0x445325(0xe3)]===_0x325f60&&lastTarget['index']===_0x1857de?colormode=(colormode+0x1)%0x3:(colormode=0x1,lastTarget={'type':_0x325f60,'index':_0x1857de}),_0x325f60==='row'?paintRow(_0x1857de,colormode):paintCol(_0x1857de,colormode),checkWin();}),resetBtn[_0x5df794(0xaf)]('click',()=>{if(!inSession)return;boardAllWhite(),checkWin();}),newBtn[_0x5df794(0xaf)](_0x5df794(0xec),()=>{const _0xb24f34=_0x5df794;if(!inSession||newBtn[_0xb24f34(0x95)])return;boardAllWhite(),generateReachableTarget(),startTimer();}),startBtn[_0x5df794(0xaf)]('click',async()=>{const _0xa67f74=_0x5df794;titleScreen[_0xa67f74(0xac)]['remove']('show'),loadScreen[_0xa67f74(0xac)][_0xa67f74(0xff)](_0xa67f74(0xcb)),await startGASSession(),loadScreen[_0xa67f74(0xac)][_0xa67f74(0xde)](_0xa67f74(0xcb)),startSession();}),toTitleBtn[_0x5df794(0xaf)]('click',()=>{const _0x512c2b=_0x5df794;resultScreen[_0x512c2b(0xac)][_0x512c2b(0xde)](_0x512c2b(0xcb)),titleScreen[_0x512c2b(0xac)]['add']('show'),endSessionToTitle();}),scoreRegBtn[_0x5df794(0xaf)](_0x5df794(0xec),()=>{openScoreModal();});function openScoreModal(){const _0x4baeab=_0x5df794;resultScreen[_0x4baeab(0xac)][_0x4baeab(0xde)]('show'),scoreModal[_0x4baeab(0xac)]['add']('show'),updateSubmitButtonState();}function closeScoreModal(){const _0x238554=_0x5df794;resultScreen[_0x238554(0xac)][_0x238554(0xff)]('show'),scoreModal[_0x238554(0xac)][_0x238554(0xde)](_0x238554(0xcb));}closeScoreModalBtn[_0x5df794(0xaf)]('click',closeScoreModal),submitScoreBtn[_0x5df794(0xaf)](_0x5df794(0xec),async()=>{const _0x39ff03=_0x5df794,_0x7d953=document[_0x39ff03(0xb4)](_0x39ff03(0xd0))[_0x39ff03(0xeb)]['trim'](),_0x152d1a=document[_0x39ff03(0xb4)](_0x39ff03(0xf7))[_0x39ff03(0xeb)],_0x31c1bc=await userIdFrom(_0x152d1a);submitScore(_0x31c1bc,_0x7d953,solvedCount),closeScoreModal(),scoreRegBtn['disabled']=!![];});async function userIdFrom(_0x1ad301){const _0x403b10=_0x5df794,_0x1a4e51=new TextEncoder()['encode'](''+_0x1ad301),_0x3f7887=await crypto[_0x403b10(0xc7)][_0x403b10(0xbd)](_0x403b10(0xaa),_0x1a4e51);return[...new Uint8Array(_0x3f7887)]['map'](_0x46f893=>_0x46f893[_0x403b10(0x9c)](0x10)['padStart'](0x2,'0'))[_0x403b10(0x9e)]('');}function updateSubmitButtonState(){const _0x506f62=_0x5df794,_0x59efa4=regName[_0x506f62(0xeb)][_0x506f62(0x100)]()[_0x506f62(0xb8)]>0x0,_0xe20b5b=regID[_0x506f62(0xeb)][_0x506f62(0x100)]()[_0x506f62(0xb8)]>0x0;submitScoreBtn[_0x506f62(0x95)]=!(_0x59efa4&&_0xe20b5b);}regName['addEventListener'](_0x5df794(0xe8),updateSubmitButtonState),regID[_0x5df794(0xaf)](_0x5df794(0xe8),updateSubmitButtonState);const API_URL=_0x5df794(0xdf);function _0x227d(_0x4bdcbb,_0x47fecf){const _0x2648fc=_0x2648();return _0x227d=function(_0x227d9f,_0x23a70b){_0x227d9f=_0x227d9f-0x94;let _0x3b087f=_0x2648fc[_0x227d9f];return _0x3b087f;},_0x227d(_0x4bdcbb,_0x47fecf);}let currentSessionId=null;async function startGASSession(){const _0x288a8e=_0x5df794,_0x40021e=await fetch(API_URL,{'method':_0x288a8e(0xd7),'headers':{'Content-Type':'text/plain;charset=utf-8'},'body':JSON[_0x288a8e(0x10b)]({'action':_0x288a8e(0xfd)})});if(!_0x40021e['ok'])throw new Error(_0x288a8e(0xba));const _0x42799a=await _0x40021e[_0x288a8e(0xc6)]();return currentSessionId=_0x42799a[_0x288a8e(0xca)],_0x42799a;}async function hitSession(){const _0x3f1d0d=_0x5df794;if(!currentSessionId)throw new Error(_0x3f1d0d(0xe5));const _0xb56e9b=await fetch(API_URL,{'method':'POST','headers':{'Content-Type':'text/plain;charset=utf-8'},'body':JSON['stringify']({'action':_0x3f1d0d(0xfb),'sessionId':currentSessionId})});if(!_0xb56e9b['ok'])throw new Error(_0x3f1d0d(0xb3));const _0xdfda29=await _0xb56e9b['json']();return _0xdfda29;}async function submitScore(_0x4a312c,_0x5610cc,_0x1b2890){const _0x35996d=_0x5df794;if(!currentSessionId)throw new Error('no\x20active\x20session');const _0x2ca9f2={'action':_0x35996d(0xcd),'sessionId':currentSessionId,'userId':_0x4a312c,'name':_0x5610cc,'scount':_0x1b2890},_0x4b1981=await fetch(API_URL,{'method':_0x35996d(0xd7),'headers':{'Content-Type':_0x35996d(0xad)},'body':JSON[_0x35996d(0x10b)](_0x2ca9f2)});if(!_0x4b1981['ok'])throw new Error(_0x35996d(0xf6));const _0x5846a4=await _0x4b1981[_0x35996d(0xc6)]();return fetchLeaderboard(),_0x5846a4;}async function fetchLeaderboard(){const _0x39dc87=_0x5df794;try{const _0x1c5aa9=await fetch(API_URL);if(!_0x1c5aa9['ok'])throw new Error(_0x39dc87(0xd3)+_0x1c5aa9[_0x39dc87(0x99)]);const _0x3777c8=await _0x1c5aa9['json']();renderLeaderboard(_0x3777c8[_0x39dc87(0xa7)][_0x39dc87(0xfe)](0x0,0x14));}catch(_0x3f668b){console[_0x39dc87(0xf1)](_0x3f668b),document['getElementById'](_0x39dc87(0xea))[_0x39dc87(0xa5)]=_0x39dc87(0xe7);}}function renderLeaderboard(_0x284ac3){const _0x534531=_0x5df794,_0x6dcad8=document['querySelector'](_0x534531(0xc1));_0x6dcad8[_0x534531(0xa5)]='',_0x284ac3[_0x534531(0xa1)]((_0x4452ec,_0x513f1c)=>{const _0x292306=_0x534531,_0x3cce2d=document[_0x292306(0x9a)]('tr'),_0x365b50=document['createElement']('td');_0x365b50[_0x292306(0x97)]=''+(_0x513f1c+0x1),_0x3cce2d[_0x292306(0xd5)](_0x365b50);const _0x12572d=document[_0x292306(0x9a)]('td');_0x12572d[_0x292306(0x97)]=_0x4452ec[_0x292306(0xf4)],_0x3cce2d[_0x292306(0xd5)](_0x12572d);const _0x4eef1f=document[_0x292306(0x9a)]('td');_0x4eef1f[_0x292306(0x97)]=_0x4452ec[_0x292306(0xf2)]*0xa,_0x3cce2d[_0x292306(0xd5)](_0x4eef1f),_0x6dcad8[_0x292306(0xd5)](_0x3cce2d);});}function _0x2648(){const _0x31c067=['regID','floor','tweetBtn','rankingCloseBtn','hit','SCORE:\x20','start','slice','add','trim','3879UjSWBs','136qRfDrX','mini-tile\x20black','fill','.tile[data-col=\x22','closest','20rAePwp','dataset','.tile[data-row=\x22','onclick','stringify','index','disabled','SCORE:\x200','textContent','\x20points\x20in\x20#25TILES\x20https://jkoizumi144.com/25tiles/','status','createElement','.ctrl','toString','is-cleared','join','482QRqXDg','setAttribute','forEach','tile','className','toggle','innerHTML','row','rows','target','col','SHA-256','gridColumn','classList','text/plain;charset=utf-8','334360pMlhAJ','addEventListener','357tTSTaj','toFixed','loadScreen','hitSession\x20failed','getElementById','div','4075815cyzIUP','ctrl','length','boardWrap','startSession\x20failed','aria-hidden','startBtn','digest','aria-label','_blank','contains','#leaderboardTable\x20tbody','mini-tile\x20red','red','8PcifVh','scoreModal','json','subtle','button','titleScreen','sessionId','show','now','submit','4414tYIlBL','I\x20scored\x20','regName','resultScreen','random','HTTP\x20error\x20','board','appendChild','216QLyjvl','POST','submitScoreBtn','toTitleBtn','3863057lvXVWQ','timerText','from','cleared','remove','https://script.google.com/macros/s/AKfycbzadRUAA5eRTcnpP7uyq71R88Af6XUZojrTb_P_SC4eVvhH0v-txbEwheaeALj50Eg_/exec','querySelectorAll','\x20を操作','scoreRegBtn','type','gridRow','no\x20active\x20session','117642xySXHn','<li>ランキングを取得できませんでした</li>','input','style','leaderboardList','value','click','newBtn','load','black','.tile','error','max','11143107AOYqFr','name','resetBtn','submitScore\x20failed'];_0x2648=function(){return _0x31c067;};return _0x2648();}window[_0x5df794(0xaf)](_0x5df794(0xee),fetchLeaderboard),inSession=![],newBtn[_0x5df794(0x95)]=!![],updateTimerDisplay(DURATION_MS),renderTargetPreview();
})();
</script>
</body>
</html>