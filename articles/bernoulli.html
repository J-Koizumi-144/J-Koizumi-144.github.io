<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Junnosuke Koizumi - Expository Notes</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VKET2GEYCJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VKET2GEYCJ');
    </script>

</head>
<body>
    <h2>冪乗和の公式と微分作用素</h2>
    <p>
        \(1\)から\(n\)までの整数の二乗和が
        \[
        \sum_{k=1}^n k^2 = \dfrac{n(n+1)(2n+1)}{6}
        \]
        と表されることは高校で習う。これを一般化し、\(1\)から\(n\)までの整数の冪乗和を\(n\)の多項式で表したものがいわゆる冪乗和の公式である。
    </p>
    <div class="theorem">
        <b class="theoremname">定理1</b>正整数\(m,n\)に対して
        \[
        \sum_{k=1}^n k^m = \dfrac{1}{m+1}\sum_{j=0}^m\binom{m+1}{j} B_j n^{m+1-j}.
        \]
    </div>
    <p>
        ただし\(B_j\)はBernoulli数と呼ばれる有理数であり、以下の母関数で定義される。
        \[
        \dfrac{xe^{tx}}{e^x-1} = \sum_{m=0}^\infty \dfrac{B_m(t)}{m!}x^m.
        \]
        なお、冪乗和の公式はしばしばFaulhaberの公式と呼ばれるが、最初に発見したのは関孝和とBernoulliであると言われている。
    </p>
    <p>
        この記事では、冪乗和の公式の演算子法による証明を紹介する。
        演算子法は微分を代数的に取り扱う手法であり、一見すると冪乗和の公式には関係ないように思われる。
        しかし、実はこの方法による証明は「なぜ二項係数が現れるのか」「なぜBernoulli数の母関数はこのような形なのか」といった疑問にエレガントな答えを与えてくれるのである。
    </p>
    <h3>微分と差分</h3>
    <p>
        不定元\(D\)を持つ形式的冪級数環\(\mathbb{Q}[[D]]\)を考えよう。有理数係数多項式\(f\in \mathbb{Q}[t]\)に対して
        \[
        Df = f'
        \]
        と定める。
        多項式は何回か微分すると\(0\)になることから、この作用により\(\mathbb{Q}[t]\)を\(\mathbb{Q}[[D]]\)加群とみなすことができる。
        有理数\(a\in \mathbb{Q}\)に対して以下のような元を考える：
        \[
        e^{aD}:=\sum_{n=0}^\infty \dfrac{a^nD^n}{n!}\in \mathbb{Q}[[D]]
        \]
        この元の\(t^m\)への作用は
        \[
        e^{aD}t^m = \sum_{n=0}^\infty\dfrac{a^nD^nt^m}{n!} = \sum_{n=0}^\infty\binom{m}{n}a^nt^{m-n} = (t+a)^m
        \]
        となるため、一般に\(e^{aD}f = f(t+a)\)となる。
        このように微分作用素の冪級数により平行移動作用素を実現することができる。また
        \[
        (e^D-1)f = f(t+1)-f(t)
        \]
        のように差分作用素も\(D\)の冪級数で表すことができる。
    </p>
    <h3>Bernoulli多項式</h3>
    <p>
        冪乗和の公式を求めるには、差分方程式
        \[
        P(t+1)-P(t)=t^m
        \]
        を解けば十分である。実際、このような\(P(t)\)があれば
        \[
        \sum_{k=1}^n k^m = \sum_{k=1}^n (P(k+1)-P(k)) = P(n+1)-P(1)
        \]
        のように冪乗和の公式が得られる。
        先ほどの観察より、この差分方程式は
        \[
        (e^D-1)P = t^m
        \]
        と表すことができる。そこで多項式\(B_m(t)\)を
        \[
        B_m(t) = \dfrac{D}{e^D-1}t^m
        \]
        で定める（冪級数\((e^D-1)/D\)は可逆であることに注意）。
        すると
        \[
        (e^D-1)B_{m+1}(t) = Dt^{m+1} = (m+1)t^m
        \]
        となるため、\(B_{m+1}/(m+1)\)が先ほどの差分方程式の解を与える。
        したがって以下の公式が得られる：
    </p>
    <div class="theorem">
        <b class="theoremname">定理2</b>正整数\(m,n\)に対して
            \[
            \sum_{k=1}^n k^m = \dfrac{B_{m+1}(n+1)-B_{m+1}(1)}{m+1}.
            \]
    </div>
    <p>
        あとは\(B_{m+1}(n+1)\)をBernoulli数で表す方法を考えればよい。
    </p>
    <h3>Bernoulli多項式とBernoulli数の関係</h3>
    <p>
        先ほどのBernoulli多項式の定義
        \[
        B_m(t)=\dfrac{D}{e^D-1}t^m
        \]
        の両辺に\(x^m/m!\)を掛けて足し合わせると
        \[
        \sum_{m=0}^\infty \dfrac{B_m(t)}{m!}x^m = \dfrac{D}{e^D-1}e^{tx}
        \]
        となる。ここで\(De^{tx}=xe^{tx}\)なので、右辺は
        \[
        \dfrac{xe^{tx}}{e^x-1}
        \]
        と書き直せる。
        \(t=1\)を代入すると右辺はBernoulli数の母関数となる。したがって\(B_m(1)=B_m\)である。
        ここからさらに\(B_m(n+1)\)の値をBernoulli数で表すために、二項定理
        \[
        e^{nD}t^m=(t+n)^m=\sum_{j=0}^m\binom{m}{j}n^{m-j}t^j
        \]
        を用いる。
        両辺に\(D/(e^D-1)\)を作用させると
        \[
        B_m(t+n)=e^{nD}B_m(t)=\sum_{j=0}^m\binom{m}{j}n^{m-j}B_j(t)
        \]
        となる。\(t=1\)を代入すれば、\(B_m(n+1)\)をBernoulli数で表す式
        \[
        B_m(n+1) = \sum_{j=0}^m\binom{m}{j}n^{m-j}B_j
        \]
        ができる。これを定理2に代入すれば冪乗和の公式が得られる。
    </p>
    <h3>まとめ</h3>
    <p>
        結局のところ、本質的なのはBernoulli多項式という差分方程式の解が構成できることであり、Bernoulli数の謎めいた定義は差分作用素の影であると考えることができる。
        冪乗和の公式に二項係数が現れるのはBernoulli多項式とBernoulli数が二項定理で結ばれているためである。
    </p>
</body>
</html>
